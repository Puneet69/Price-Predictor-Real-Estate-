#!/bin/bash

# üöÄ RAILWAY BACKEND + VERCEL FRONTEND DEPLOYMENT

clear
echo "üöÄ DEPLOY BACKEND TO RAILWAY + FRONTEND TO VERCEL"
echo "================================================"
echo ""
echo "üéØ PERFECT COMBINATION:"
echo "   Backend: Railway (Python/FastAPI) - $0-5/month"
echo "   Frontend: Vercel (React) - FREE"
echo "   Database: MongoDB Atlas - FREE"
echo "   Total: $0-5/month with excellent performance!"
echo ""

# Function to wait for user input
wait_for_user() {
    echo ""
    echo "Press ENTER to continue..."
    read
    clear
}

# Part 1: Railway Backend
echo "üöÇ PART 1: DEPLOY BACKEND TO RAILWAY"
echo "===================================="
echo ""
echo "üìã Steps to deploy your Python/FastAPI backend:"
echo ""
echo "1. Go to: https://railway.app"
echo "2. Sign in with GitHub"
echo "3. Click 'New Project'"
echo "4. Select 'Deploy from GitHub repo'"
echo "5. Choose: Puneet69/Price-Predictor-Real-Estate-"
echo "6. ‚ö†Ô∏è  CRITICAL: Set 'Root Directory' to: backend"
echo "7. Click 'Deploy'"
echo ""
echo "‚è±Ô∏è  Backend will build in 2-3 minutes"
echo ""
echo "üîß Add MongoDB Environment Variable:"
echo "   - Go to 'Variables' tab"
echo "   - Name: MONGODB_URI"
echo "   - Value: mongodb+srv://price_predictor:vlMUA2FIr48bnJWO@realestate.caqfzde.mongodb.net/property_comparison?retryWrites=true&w=majority&appName=RealEstate"
echo ""
echo "‚úÖ After deployment, copy your backend URL:"
echo "   Should look like: https://backend-production-xxxx.up.railway.app"
echo ""
echo "üß™ Test backend by visiting: [your-backend-url]/docs"
wait_for_user

# Part 2: Vercel Frontend
echo "‚ö° PART 2: DEPLOY FRONTEND TO VERCEL"
echo "==================================="
echo ""
echo "üìã Steps to deploy your React frontend:"
echo ""
echo "1. Go to: https://vercel.com"
echo "2. Click 'Sign Up' ‚Üí 'Continue with GitHub'"
echo "3. Authorize Vercel"
echo "4. Click 'New Project'"
echo "5. Select: Puneet69/Price-Predictor-Real-Estate-"
echo ""
echo "6. ‚ö†Ô∏è  CRITICAL PROJECT SETTINGS:"
echo "   Framework Preset: Create React App"
echo "   Root Directory: frontend"
echo "   Build Command: npm run build"
echo "   Output Directory: build"
echo ""
echo "7. ‚ö†Ô∏è  ADD ENVIRONMENT VARIABLE:"
echo "   Name: REACT_APP_API_URL"
echo "   Value: [Your Railway backend URL from Part 1]"
echo "   Environment: All (Production, Preview, Development)"
echo ""
echo "8. Click 'Deploy'"
echo ""
echo "‚è±Ô∏è  Frontend will build in 2-3 minutes"
echo ""
echo "‚úÖ After deployment, you'll get a URL like:"
echo "   https://your-app.vercel.app"
wait_for_user

# Testing
echo "üß™ PART 3: TEST YOUR HYBRID DEPLOYMENT"
echo "======================================"
echo ""
echo "üöÇ Test Railway Backend:"
echo "1. Visit: [your-backend-url]/docs"
echo "   Should see FastAPI documentation"
echo "2. Test: [your-backend-url]/health"
echo "   Should return status information"
echo ""
echo "‚ö° Test Vercel Frontend:"
echo "1. Visit: https://your-app.vercel.app"
echo "   Should load your React app"
echo "2. Test property comparison:"
echo "   Property 1: 123 Main St, San Francisco, CA"
echo "   Property 2: 456 Oak Ave, Los Angeles, CA"
echo "3. Check browser console (F12) for errors"
echo ""
echo "üîó Integration Test:"
echo "‚úÖ Properties load without errors"
echo "‚úÖ Price predictions display"
echo "‚úÖ Comparison charts appear"
echo "‚úÖ No CORS errors"
echo "‚úÖ Mobile responsive"
wait_for_user

# Troubleshooting
echo "üõ†Ô∏è  TROUBLESHOOTING COMMON ISSUES"
echo "================================="
echo ""
echo "‚ùå Railway Backend Issues:"
echo ""
echo "üîß If 'Root Directory' not visible:"
echo "   1. Deploy first (may fail)"
echo "   2. Go to service 'Settings'"
echo "   3. Change 'Source Path' to 'backend'"
echo "   4. Redeploy"
echo ""
echo "üîß If build fails:"
echo "   1. Check build logs in Railway dashboard"
echo "   2. Verify requirements.txt exists"
echo "   3. Check Python version compatibility"
echo ""
echo "‚ùå Vercel Frontend Issues:"
echo ""
echo "üîß If build fails:"
echo "   1. Check build logs in Vercel dashboard"
echo "   2. Verify package.json exists in frontend/"
echo "   3. Check React version compatibility"
echo ""
echo "üîß If API calls fail:"
echo "   1. Verify REACT_APP_API_URL is set correctly"
echo "   2. Check backend CORS configuration"
echo "   3. Test backend URL directly"
echo ""
echo "‚ùå Connection Issues:"
echo ""
echo "üîß Frontend can't reach backend:"
echo "   1. Check REACT_APP_API_URL environment variable"
echo "   2. Ensure backend URL is accessible"
echo "   3. Verify CORS settings in backend/main.py"
wait_for_user

# Success and Next Steps
echo "üéâ SUCCESS! YOUR HYBRID DEPLOYMENT IS COMPLETE"
echo "=============================================="
echo ""
echo "üèÜ You now have:"
echo "‚úÖ Railway Backend: Fast Python/FastAPI server"
echo "‚úÖ Vercel Frontend: Lightning-fast React app with global CDN"
echo "‚úÖ MongoDB Atlas: Cloud database"
echo "‚úÖ Auto-deployments: Push to GitHub = automatic updates"
echo ""
echo "üí∞ Monthly Costs:"
echo "   Railway: $0 (with $5 free credit)"
echo "   Vercel: $0 (free tier)"
echo "   MongoDB: $0 (free M0 tier)"
echo "   Total: $0/month to start!"
echo ""
echo "üåç Performance Benefits:"
echo "‚úÖ Global CDN for frontend (Vercel)"
echo "‚úÖ Optimized Python backend (Railway)"
echo "‚úÖ Cloud database (MongoDB Atlas)"
echo "‚úÖ Auto-scaling capabilities"
echo "‚úÖ Professional URLs"
echo ""
echo "üì± Your Live URLs:"
echo "   Frontend: https://your-app.vercel.app"
echo "   Backend: https://backend-production-xxxx.up.railway.app"
echo "   API Docs: https://backend-production-xxxx.up.railway.app/docs"
echo ""
echo "üöÄ Next Steps:"
echo "‚ñ° Bookmark your live URLs"
echo "‚ñ° Share with friends and family"
echo "‚ñ° Add to your portfolio/resume"
echo "‚ñ° Test on different devices"
echo "‚ñ° Consider custom domain (optional)"
echo ""
echo "üéØ DEPLOYMENT COMPLETE!"
echo "Your Property Comparison App is now live with the best"
echo "performance and cost combination possible!"
echo ""
echo "=============================================="